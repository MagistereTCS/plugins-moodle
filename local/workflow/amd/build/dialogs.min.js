define(["jquery","jqueryui","local_workflow/jquery.loadingModal"],function(a){function b(){function b(){a("#wf_createparcoursfromgabarit_form").submit()}function d(){a("#wf_createsessionfromWFParcoursForm").submit()}function e(){a("#wf_recreatesessionfromWFParcoursForm").submit()}function f(){a("#wf_duplicate_form").submit()}a("#wf_dialog_createparcoursfromgabarit").dialog({autoOpen:!1,width:600,height:250,title:"Créer un parcours de formation",draggable:"false",modal:!0,resizable:!1,closeOnEscape:!1,closeText:"Fermer",buttons:[{text:"Créer ",id:"btCreerCours",click:function(){""==a('#wf_dialog_createparcoursfromgabarit input[name="new_course_name"]').val()?alert("Le nom est obligatoire"):""==a('#wf_dialog_createparcoursfromgabarit input[name="new_course_shortname"]').val()?alert("Le nom abrégé est obligatoire"):b()}},{text:"Annuler",id:"btAnnuler",click:function(){a(this).dialog("close")}}]}),a("#wf_link_createparcoursfromgabarit").click(function(b){b.preventDefault(),c("#wf_link_createparcoursfromgabarit"),a("#wf_dialog_createparcoursfromgabarit").show(),a("#wf_dialog_createparcoursfromgabarit").dialog("open")}),a("#wf_dialog_createsessionfromparcours").dialog({autoOpen:!1,width:600,height:470,title:"Créer une session de formation",draggable:"false",modal:!0,resizable:!1,closeOnEscape:!1,closeText:"Fermer",buttons:[{text:"Créer ",id:"btCreerCours",click:function(){""==a('#wf_dialog_createsessionfromparcours input[name="new_course_name"]').val()?alert("Le nom est obligatoire"):""==a('#wf_dialog_createsessionfromparcours input[name="new_course_shortname"]').val()?alert("Le nom abrégé est obligatoire"):d()}},{text:"Annuler",id:"btAnnuler",click:function(){a(this).dialog("close")}}]}),a("#wf_link_createsessionfromparcours").click(function(b){b.preventDefault(),a("#wf_dialog_createsessionfromparcours").show(),a('input[name="datepicker_session"]').show(),a("#wf_dialog_createsessionfromparcours").dialog("open")}),a("#wf_dialog_recreatesessionfromparcours").dialog({autoOpen:!1,width:600,height:470,title:"Créer une nouvelle session de formation",draggable:"false",modal:!0,resizable:!1,closeOnEscape:!1,closeText:"Fermer",buttons:[{text:"Créer ",id:"btCreerCours",click:function(){""==a('#wf_dialog_recreatesessionfromparcours input[name="new_course_name"]').val()?alert("Le nom est obligatoire"):""==a('#wf_dialog_recreatesessionfromparcours input[name="new_course_shortname"]').val()?alert("Le nom abrégé est obligatoire"):e()}},{text:"Annuler",id:"btAnnuler",click:function(){a(this).dialog("close")}}]}),a("#wf_link_recreatesessionfromparcours").click(function(b){b.preventDefault(),a("#wf_dialog_recreatesessionfromparcours").show(),a('input[name="datepicker_session"]').show(),a("#wf_dialog_recreatesessionfromparcours").dialog("open")}),a("#wf_dialog_archive").dialog({autoOpen:!1,width:600,title:"Archivage de la session de formation",draggable:"false",modal:!0,resizable:!1,closeOnEscape:!1,closeText:"Fermer",buttons:[{text:"Archiver",id:"btCreerCours",click:function(){a("#wf_archive_form").submit()}},{text:"Annuler",id:"btAnnuler",click:function(){a(this).dialog("close")}}]}),a("#wf_link_archive").click(function(b){b.preventDefault(),c("#wf_link_archive"),a("#wf_dialog_archive").show(),a("#wf_dialog_archive").dialog("open")}),a("#wf_dialog_duplicate").dialog({autoOpen:!1,width:600,title:"Duplication dans la même catégorie",draggable:"false",modal:!0,resizable:!1,closeOnEscape:!1,closeText:"Fermer",buttons:[{text:"Création du cours",id:"btCreerCours",click:function(){""==a('#wf_dialog_duplicate input[name="new_course_name"]').val()?alert("Le nom est obligatoire"):""==a('#wf_dialog_duplicate input[name="new_course_shortname"]').val()?alert("Le nom abrégé est obligatoire"):f()}},{text:"Annuler",id:"btAnnuler",click:function(){a(this).dialog("close")}}]}),a("#wf_link_duplicate").click(function(b){b.preventDefault(),c("#wf_link_duplicate"),a("#wf_dialog_duplicate").show(),a("#wf_dialog_duplicate").dialog("open")}),a("#wf_dialog_unarchive").dialog({autoOpen:!1,width:600,title:"Réouverture ",draggable:"false",modal:!0,resizable:!1,closeOnEscape:!1,closeText:"Fermer",buttons:[{text:"Rouvrir",id:"btCreerCours",click:function(){a("#wf_unarchive_form").submit()}},{text:"Annuler",id:"btAnnuler",click:function(){a(this).dialog("close")}}]}),a("#wf_link_unarchive").click(function(b){b.preventDefault(),c("#wf_link_unarchive"),a("#wf_dialog_unarchive").show(),a("#wf_dialog_unarchive").dialog("open")}),a("#wf_dialog_discard").dialog({autoOpen:!1,width:400,title:"Mettre à la corbeille",draggable:"false",modal:!0,resizable:!1,closeOnEscape:!1,closeText:"Fermer",buttons:[{text:"Oui",id:"btDiscard",click:function(){a("#wf_discard_form").submit()}},{text:"Annuler",id:"btCancel",click:function(){a(this).dialog("close")}}]}),a("#wf_link_discard").click(function(b){b.preventDefault(),c("#wf_link_discard"),a("#wf_dialog_discard").show(),a("#wf_dialog_discard").dialog("open")}),a("#wf_dialog_open_session").dialog({autoOpen:!1,width:400,title:"Ouvrir la session",draggable:"false",modal:!0,resizable:!1,closeOnEscape:!1,closeText:"Fermer",buttons:[{text:"Oui",id:"btOpenSession",click:function(){a("#wf_open_session_form").submit()}},{text:"Annuler",id:"btCancel",click:function(){a(this).dialog("close")}}]}),a("#wf_link_open_session").click(function(b){b.preventDefault(),c("#wf_link_open_session"),a("#wf_dialog_open_session").show(),a("#wf_dialog_open_session").dialog("open")}),a("#wf_dialog_open_auto_inscription").dialog({autoOpen:!1,width:400,title:"Ouvrir la session en auto-inscription",draggable:"false",modal:!0,resizable:!1,closeOnEscape:!1,closeText:"Fermer",buttons:[{text:"Oui",id:"btOpenSession",click:function(){a("#wf_open_auto_inscription_form").submit()}},{text:"Annuler",id:"btCancel",click:function(){a(this).dialog("close")}}]}),a("#wf_link_open_auto_inscription").click(function(b){b.preventDefault(),c("#wf_link_open_auto_inscription"),a("#wf_dialog_open_auto_inscription").show(),a("#wf_dialog_open_auto_inscription").dialog("open")}),a("#wf_dialog_restorefromtrash").dialog({autoOpen:!1,width:600,title:"Restauration du parcours",draggable:"false",modal:!0,resizable:!1,closeOnEscape:!1,closeText:"Fermer",buttons:[{text:"Restaurer",id:"btDiscard",click:function(){a("#wf_restorefromtrash_form").submit()}},{text:"Annuler",id:"btCancel",click:function(){a(this).dialog("close")}}]}),a("#wf_link_restorefromtrash").click(function(b){b.preventDefault(),c("#wf_link_restorefromtrash"),a("#wf_dialog_restorefromtrash").show(),a("#wf_dialog_restorefromtrash").dialog("open")}),a("#wf_dialog_publish").dialog({autoOpen:!1,width:400,title:"Publier/Mettre à jour dans l'offre",draggable:"false",modal:!0,resizable:!1,closeOnEscape:!1,closeText:"Fermer",buttons:[{text:"Oui",id:"btPublish",click:function(b){b.preventDefault(),a(this).dialog("close"),a("body").loadingModal({position:"auto",text:"Publication/Mise à jour du parcours en cours",color:"#fff",opacity:"0.7",backgroundColor:"rgb(0,0,0)",animation:"circle"}),a.post(a("#wf_publish_form").attr("action"),a("#wf_publish_form").serialize(),function(b){"false"==b.error?(a("body").loadingModal("animation","doubleBounce"),a("body").loadingModal("text","Le parcours a été publié/mis à jour<br/><input type='button' id='close' value='Continuer' onclick='window.location.reload()'>")):(a("body").loadingModal("animation","doubleBounce"),a("body").loadingModal("text","La publication/mise à jour du parcours a échouée<br/><input type='button' id='close' value='Continuer' onclick='window.location.reload()'>"))},"json")}},{text:"Annuler",id:"btCancel",click:function(){a(this).dialog("close")}}]}),a("#wf_link_publish").click(function(b){b.preventDefault(),c("#wf_link_publish"),a("#wf_dialog_publish").show(),a("#wf_dialog_publish").dialog("open")}),a("#wf_dialog_unpublish").dialog({autoOpen:!1,width:400,title:"Dépublier de l'offre",draggable:"false",modal:!0,resizable:!1,closeOnEscape:!1,closeText:"Fermer",buttons:[{text:"Oui",id:"btUnpublish",click:function(){a("#wf_unpublish_form").submit()}},{text:"Annuler",id:"btCancel",click:function(){a(this).dialog("close")}}]}),a("#wf_link_unpublish").click(function(b){b.preventDefault(),c("#wf_link_unpublish"),a("#wf_dialog_unpublish").show(),a("#wf_dialog_unpublish").dialog("open")})}function c(b){a("input").each(function(){a(this).is('input[name="new_course_name"]')?a(this).val(""):a(this).is('input[name="new_course_shortname"]')?a(this).val(""):a(this).is('input[name="datepicker_session"]')&&a(this).val("")}),a(b+' select[name*="new_category_course"]').val(a(b+' select[name="new_category_course"] option').first().val())}return{init:function(){b()}}});